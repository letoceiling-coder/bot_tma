/**
 * ============================================================
 * Глобальный миксин Storage
 * ============================================================
 * 
 * Предоставляет реактивное хранилище данных для всех компонентов.
 * Используется для хранения временных данных, состояния UI компонентов,
 * и других данных, которые не нужно сохранять в Vuex Store.
 * 
 * @mixin storage
 * @description Добавляет свойство this.storage во все компоненты
 * 
 * @example Использование в компоненте
 * // Сохранение данных
 * this.storage.media = { folders: [], current: null };
 * 
 * // Чтение данных
 * const folders = this.storage.media?.folders || [];
 * 
 * // Проверка существования
 * if (!this.storage.media) {
 *   this.storage.media = { folders: [] };
 * }
 */

import { reactive } from 'vue';

// Создаём глобальное реактивное хранилище
const globalStorage = reactive({
    /**
     * Хранилище для медиа-менеджера
     */
    media: {
        folders: [],      // Список папок
        current: null,    // ID текущей папки
        filter: {}        // Фильтры для списка
    },
    
    /**
     * Массив ошибок валидации
     * 
     * Структура ошибки:
     * {
     *   name: 'field_name',  // Название поля
     *   message: 'Error text' // Текст ошибки
     * }
     */
    errors: [],
    
    /**
     * Другие разделы можно добавлять по необходимости
     * 
     * @example
     * forms: {},
     * ui: {},
     * cache: {}
     */
});

export default {
    /**
     * Хук жизненного цикла: перед созданием компонента
     * 
     * Делаем storage доступным как свойство экземпляра
     */
    beforeCreate() {
        /**
         * Глобальное реактивное хранилище
         * 
         * Структура данных:
         * {
         *   media: {
         *     folders: [],      // Список папок медиа-менеджера
         *     current: null,    // ID текущей папки
         *     filter: {}        // Фильтры для списка
         *   },
         *   // Другие временные данные...
         * }
         * 
         * @type {Object}
         */
        this.storage = globalStorage;
    }
};

